# GitNetDisk 最终使用指南

## 项目完成状态

✅ 前端开发完成  
✅ 后端开发完成  
✅ Token 验证修复  
✅ 文件上传功能修复  
✅ 代理配置功能完成  
✅ **PWA 配置完成**  
✅ 打包部署文档完成  

## 当前可用功能

### 1. 用户认证
- GitHub Token 登录
- Token 格式：`token ghp_xxxxx`
- 自动保存登录状态

### 2. 仓库管理
- 查看所有仓库
- 创建新仓库
- 浏览仓库文件

### 3. 文件操作
- 上传文件（支持拖拽）
- 上传文件夹（自动过滤 .git）
- 下载文件
- 删除文件
- 查看文件内容

### 4. 代理配置
- 支持 HTTP/SOCKS5 代理
- 推荐使用 Clash 本地代理：`http://127.0.0.1:7890`
- 动态代理切换

### 5. PWA 支持 🆕
- 可安装到手机桌面
- 离线缓存
- 原生 APP 体验

## 快速开始

### 本地开发

```bash
# 启动后端
cd git-net-disk
go run main.go

# 启动前端（新终端）
cd git-web
npm install
npm run dev
```

访问：http://localhost:5173

## 打包成 APP

### 第 1 步：生成 PWA 图标

**最简单方法**（推荐）：
1. 访问 https://www.pwabuilder.com/imageGenerator
2. 上传 `git-web/public/icon.svg`
3. 下载生成的图标到 `git-web/public/` 目录

需要的文件：
- `pwa-192x192.png`
- `pwa-512x512.png`
- `apple-touch-icon.png`

**命令行方法**：
```bash
npm install -g sharp-cli
cd git-web/public
npx sharp -i icon.svg -o pwa-192x192.png resize 192 192
npx sharp -i icon.svg -o pwa-512x512.png resize 512 512
npx sharp -i icon.svg -o apple-touch-icon.png resize 180 180
```

### 第 2 步：构建前端

```bash
cd git-web
npm run build
```

### 第 3 步：本地测试

```bash
npm run preview
```

打开浏览器访问显示的地址，测试 PWA 功能。

### 第 4 步：部署到服务器

**前端部署（Vercel - 免费）**：
```bash
npm install -g vercel
cd git-web
vercel --prod
```

**后端部署（Railway - 免费）**：
1. 访问 https://railway.app
2. 连接 GitHub 仓库
3. 选择 `git-net-disk` 目录
4. 自动部署

### 第 5 步：配置环境变量

创建 `git-web/.env.production`：
```env
VITE_API_URL=https://your-railway-backend.up.railway.app
```

重新部署前端：
```bash
vercel --prod
```

### 第 6 步：手机安装

**iOS (Safari)**：
1. 打开部署后的网址
2. 点击分享按钮
3. 选择"添加到主屏幕"

**Android (Chrome)**：
1. 打开部署后的网址
2. 浏览器会自动提示"安装应用"
3. 点击安装

完成！现在你的手机桌面上有一个像原生 APP 一样的图标了。

## 使用说明

### 登录

1. 获取 GitHub Token：
   - 访问 https://github.com/settings/tokens
   - 点击 "Generate new token (classic)"
   - 勾选 `repo` 权限
   - 生成并复制 Token

2. 在应用中输入 Token 登录

### 上传文件

**方法 1：拖拽上传**
- 直接拖拽文件到文件列表区域

**方法 2：点击上传**
- 点击"上传文件"按钮
- 选择文件

**方法 3：上传文件夹**
- 点击"上传文件夹"按钮
- 选择文件夹
- 自动过滤 `.git` 文件

### 代理设置

如果你所在地区无法直接访问 GitHub：

1. 安装并运行 Clash
2. 在设置中配置代理：`http://127.0.0.1:7890`
3. 保存设置

## 技术架构

### 前端
- **框架**：React 19 + TypeScript
- **构建**：Vite 6
- **样式**：Tailwind CSS
- **状态**：Zustand
- **PWA**：vite-plugin-pwa
- **端口**：5173

### 后端
- **语言**：Go 1.21+
- **框架**：Gin
- **功能**：GitHub API 代理
- **端口**：3000

### 通信流程
```
前端 (5173) → 后端 (3000) → GitHub API
                ↓
            代理支持 (可选)
```

## 文件结构

```
github/
├── git-net-disk/          # 后端
│   ├── api/              # API 路由
│   ├── internal/         # 内部逻辑
│   │   ├── github/      # GitHub 客户端
│   │   └── proxy/       # 代理支持
│   ├── main.go          # 入口
│   └── Dockerfile       # Docker 配置
│
├── git-web/              # 前端
│   ├── components/      # React 组件
│   ├── services/        # API 服务
│   ├── public/          # 静态资源
│   │   ├── icon.svg    # 图标源文件
│   │   ├── pwa-192x192.png
│   │   ├── pwa-512x512.png
│   │   └── apple-touch-icon.png
│   ├── App.tsx          # 主应用
│   ├── vite.config.ts   # Vite + PWA 配置
│   └── package.json
│
└── dose/                 # 文档
    ├── 快速打包指南.md
    ├── APP打包部署指南.md
    ├── PWA图标生成指南.md
    └── ...
```

## 常见问题

### Q: Token 验证失败？
A: 确保 Token 格式正确，包含 `repo` 权限

### Q: 文件上传失败？
A: 
1. 检查文件路径是否包含特殊字符
2. 确认 Token 有写入权限
3. 查看浏览器控制台错误

### Q: 代理不生效？
A: 
1. 确认 Clash 正在运行
2. 代理地址设置为 `http://127.0.0.1:7890`
3. 检查 Clash 端口配置

### Q: PWA 无法安装？
A: 
1. 确保使用 HTTPS（生产环境）
2. 确认图标文件存在
3. iOS 需要手动添加（Safari 分享菜单）

### Q: 手机上无法连接后端？
A: 
1. 确保后端已部署到公网
2. 检查 `.env.production` 配置
3. 确认 CORS 设置正确

### Q: 图标不显示？
A: 
1. 确保图标文件名正确
2. 文件放在 `public/` 目录
3. 重新构建项目

## 性能优化

### 前端
- ✅ 代码分割
- ✅ 懒加载
- ✅ PWA 缓存
- ✅ 图片优化

### 后端
- ✅ GZIP 压缩
- ✅ 请求缓存
- ✅ 连接池
- ✅ 错误处理

## 安全建议

1. **Token 安全**
   - 不要分享你的 Token
   - 定期更换 Token
   - 使用最小权限原则

2. **HTTPS**
   - 生产环境必须使用 HTTPS
   - 使用 Let's Encrypt 免费证书

3. **CORS**
   - 限制允许的域名
   - 不要使用 `*` 通配符

## 成本估算

### 免费方案（推荐）
- 前端：Vercel（免费）
- 后端：Railway（$5 免费额度）
- **总计：免费**

### 付费方案
- 前端：Vercel Pro（$20/月）
- 后端：云服务器（$5-10/月）
- 域名：$10/年
- **总计：$30-40/月**

## 下一步计划

可选的功能扩展：

- [ ] 文件搜索
- [ ] 文件预览（图片、PDF）
- [ ] 批量操作
- [ ] 分享链接
- [ ] 多用户支持
- [ ] 文件版本历史
- [ ] 移动端优化
- [ ] 离线编辑

## 相关文档

- [快速打包指南](./快速打包指南.md) - 详细的打包步骤
- [APP打包部署指南](./APP打包部署指南.md) - 完整的部署方案
- [PWA图标生成指南](./PWA图标生成指南.md) - 图标生成方法
- [前端开发文档](./前端开发文档.md) - 前端技术细节
- [后端开发文档](./后端开发文档.md) - 后端技术细节
- [Token验证指南](./Token验证指南.md) - Token 问题排查
- [代理配置功能说明](./代理配置功能说明.md) - 代理使用说明

## 支持

如有问题，请查看文档或提交 Issue。

---

**项目完成！🎉**

现在你可以：
1. ✅ 生成 PWA 图标
2. ✅ 构建项目
3. ✅ 部署到服务器
4. ✅ 在手机上安装使用

祝使用愉快！
